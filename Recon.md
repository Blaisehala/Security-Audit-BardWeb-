# BardWeb Django Application Reconnaissance

## Application Purpose
The Bard Alumni Website is a membership-based social platform designed to connect Barding High school alumni. It provids a centralized  hub for alumni to network, share updated, organize events, donate to school initiatives and maintain conncections. Importantly it helps in tracking  financial investment  by members. The platform features member verification through M-pesa payment intergration, ensures only registerded alumni can access community features and includes administrative tools for managing membershp, events and donations

## Technology Stack
- Django version: 5.1.3
- Django version:3.11+
- Database:PostgreSQL 16 (Production: Render PostgreSQL, Development: Local PostgreSQL)
- Authentication:Django's built-in authentication system with custom User model
- Web Server : Gunicorn (production)
- Static Files: WhiteNoise + Cloudinary
- Key Libraries: 

    - **psycopg2-binary==2.9.9** -- PostgreSQL adapter
  

    - **python-decouple==3.8** -- Environment variable management
  

    - **dj-database-url==2.2.0** -- Database URL parsing

    - **whitenoise==6.8.2** --   Static file serving
 
    - **cloudinary==1.41.0** --  Cloud media storage

    - **django-cloudinary-storage==0.3.0** --Django integration for Cloudinary
    - **Pillow==10.4.0**  -- Image processing
 

## User Roles & Permissions

- **Anonymous users can:** 

    [] View public homepage only

    [] Access registration page (but must provide valid member number + secret code)

    [] Cannot access any member features

    [] Cannot view alumni directory, events, or member content

    [] Can donate to the alumni     

-  **Authenticated users can:**

    [] View public homepage only

    [] Access registration page (but must provide valid member number + secret code)

    [] Cannot access any member features

    [] Cannot view alumni directory, events, or member content


   **Admin users can:**

    [] View member dashboard with social feed

    [] Create, edit, and delete their own profile 

    [] Upload profile pictures (stored in Cloudinary)

    [] View alumni directory (all verified members)

## Data Models
**1. Custom User Model** (`users.CustomUser`) 

   - **Fields :**

`id` - Primary Key (AutoField)

`username` - CharField (unique, max_length=150)

`email` - EmailField (unique)

`password` - CharField (hashed with Django's PBKDF2)

`first_name` - CharField (max_length=150)

`last_name` - CharField (max_length=150)

`phone_number` - CharField (max_length=15, optional)

`graduation_year` - IntegerField (default=2014)

`current_occupation` - CharField (max_length=200, optional)

`current_location` - CharField (max_length=200, optional)

`bio` - TextField(optional)

`profile_picture` - CloudinaryField (stored in Cloudinary)

`member_number` - ForeignKey to MemberNumber (unique, validated during registration)

`is_verified` - BooleanField (default=False, set to True after payment verification)

`is_active` - BooleanField (default=True)

`is_staff` - BooleanField (default=False)

`is_superuser` - BooleanField (default=False)

`date_joined `- DateTimeField (auto_now_add=True)

`last_login` - DateTimeField (nullable)

  - **Relationships:**

    - One-to-One With MemberNumber
    - One-to-Many with Donation
    - Many-to-Many with Event (through RSVP)     
--------------------------

   **2. Member Number** (`bardapp.MemberNumber`) 
   - **Fields :**

`id` - Primary Key (AutoField)

`number` - CharField (unique, max_length=10) - Format: "BA-XXXX"

`is_used` - BooleanField (default=False)

`assigned_to` - OneToOneField to CustomUser (nullable, set when user registers)

`created_at` - DateTimeField (auto_now_add=True)

`used_at` - DateTimeField (nullable, set when number is claimed)

 - **Security Notes:**

    - Member numbers are pre-generated by admins
    - Each number can only be used once
    - Prevents unauthorized registrations
-------------
**3. Secret Code (`bardapp.SecretCode`)**

- **Fields :**

`id` - Primary Key (AutoField)

`code` - CharField (unique, max_length=50)

`is_active` - BooleanField (default=True)

`created_at` - DateTimeField (auto_now_add=True)

`expires_at` - DateTimeField (nullable)

`usage_count` - IntegerField (default=0)

`max_uses` - IntegerField (nullable, unlimited if null)

- **Security Notes :**

    - Used as second factor in registration
    - Can be rotated by admins
    - Tracks usage to detect abuse
______

**4. Event (`bardapp.Event`)**

- **Fields :**

`id` - Primary Key (AutoField)

`title` - CharField (max_length=200)

`description` - TextField

`event_date` - DateTimeField

`location` - CharField (max_length=300)

`event_type` - CharField (choices: 'reunion', 'meetup', 'webinar', 'networking')

`max_attendees` - IntegerField (nullable, unlimited if null)

`is_public` - BooleanField (default=False) - If True, visible to non-members

`created_by` - ForeignKey to CustomUser

`created_at` - DateTimeField (auto_now_add=True)

`updated_at` - DateTimeField (auto_now=True)

`image` - CloudinaryField (optional)

 - **Relationships :**

   - Many-to-Many with CustomUser (through RSVP)

-----------------------------------
**5. RSVP (`bardapp.RSVP`)**

- **Fields :**

`id` - Primary Key (AutoField)

`user` - ForeignKey to CustomUser

`event` - ForeignKey to Event

`event` - ForeignKey to Event

`status` - CharField (choices: 'attending', 'maybe', 'not_attending')

`created_at` - DateTimeField (auto_now_add=True)

`updated_at` - DateTimeField (auto_now=True)


 - **Constraints :**

   - `unique_together = ('user', 'event')` - One RSVP per user per event
___________

**6. Donation (`bardapp.Donation`)**

- **Fields :**

`id` - Primary Key (AutoField)

`user` -  ForeignKey to CustomUser (nullable, allows anonymous donations)

`amount` - DecimalField (max_digits=10, decimal_places=2)

`currency` - CharField (default='KES', max_length=3)

`donation_type` - CharField (choices: 'scholarship', 'school_project', 'general', 'emergency')

`payment_method` - CharField (choices: 'mpesa', 'card', 'bank_transfer')

`mpesa_transaction_id` - CharField (max_length=100, unique, nullable)

`payment_status` -CharField (choices: 'pending', 'completed', 'failed', 'refunded')

`is_anonymous` - BooleanField (default=False)

`message` - TextField (optional)

`created_at` - DateTimeField (auto_now_add=True)

`processed_at` - DateTimeField (nullable)

 - **security Notes :**

   - Transaction IDs are unique and identified
   - Payment status prevents double-processing 
   - Anonymous donations protect donor privacy 
___________

**3. Secret Code (`bardapp.SecretCode`)**

- **Fields :**

`id` - Primary Key (AutoField)

`title` - CharField (max_length=200)

`description` - TextField

`event_date` - DateTimeField

`location` - CharField (max_length=300)

`event_type` - CharField (choices: 'reunion', 'meetup', 'webinar', 'networking')

`max_attendees` - IntegerField (nullable, unlimited if null)

`is_public` - BooleanField (default=False) - If True, visible to non-members

`created_by` - ForeignKey to CustomUser

`created_at` - DateTimeField (auto_now_add=True)

`updated_at` - DateTimeField (auto_now=True)

`image` - CloudinaryField (optional)

 - **Relationships :**

   - Many-to-Many with CustomUser (through RSVP)

_______________

**3. Secret Code (`bardapp.SecretCode`)**

- **Fields :**

`id` - Primary Key (AutoField)

`title` - CharField (max_length=200)

`description` - TextField

`event_date` - DateTimeField

`location` - CharField (max_length=300)

`event_type` - CharField (choices: 'reunion', 'meetup', 'webinar', 'networking')

`max_attendees` - IntegerField (nullable, unlimited if null)

`is_public` - BooleanField (default=False) - If True, visible to non-members

`created_by` - ForeignKey to CustomUser

`created_at` - DateTimeField (auto_now_add=True)

`updated_at` - DateTimeField (auto_now=True)

`image` - CloudinaryField (optional)

 - **Relationships :**

   - Many-to-Many with CustomUser (through RSVP)

____________


## API Endpoints Map

### Authentication
- POST /api/register/ - Creates new user
- POST /api/login/ - Returns JWT token
[complete this for EVERY endpoint]

## Data Flow Example
"User registers -> receives JWT -> creates task -> task saved with user_id -> user queries their tasks"

## Potential Attack Surface (Initial Thoughts)
- User input points: registration form, login, task creation, search
- Database queries: search functionality looks suspicious
- Authentication: need to test authorization on task endpoints
- File uploads: [if applicable]